I have improved the logic as per the request and kindly validate the same.
Thanks.
